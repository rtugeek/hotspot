import{a as x}from"./axios.js";import{W as I,g as v,d as y,o as n,c as o,r as P,a as U,t as d,_ as k,b as w,e as j,f as a,F as g,h,i as f,j as C,p as N,k as S}from"./index.js";class W{static getWidgetUrl(e,t,i){let s="";return e.startsWith("http")?s=e:s=t.getIndexUrl()+e,s.includes("?")?s+"&"+i.toUrlParams().toString():s+"?"+i.toUrlParams().toString()}static getWidgetPackageIndexUrl(e,t,i){const s=[e];return e.startsWith("http")?i&&s.push(e.endsWith("/")?"#":"/#"):(s.push(t.startsWith("/")?t:`/${t}`),i&&s.push(e.endsWith("#")?"":"#")),s.join("")}}class _{constructor(e){if(this.hash=!0,this.widgets=[],this.name=e.name,this.version=e.version,this.author=e.author,this.homepage=e.homepage,this.title=e.title,this.description=e.description,this.entry=e.entry,this.remoteEntry=e.remoteEntry,this.remotePackage=e.remotePackage,this.hash=e.hash,this.url=e.url,this.icon=e.icon,this.devOptions=e.devOptions,e.widgets)for(let t of e.widgets)this.widgets.push(t)}static parseJSON(e){const t=JSON.parse(e);return this.parseObject(t)}static parseObject(e){let t=new _({author:"",description:{"zh-CN":""},entry:"",hash:!1,homepage:"",name:"",title:{"zh-CN":""},url:"",version:""});Object.assign(t,e);const i=[];if(t.widgets)for(let s of t.widgets){let u=new I({description:{"zh-CN":""},height:0,keywords:[],lang:"zh-CN",name:"",routes:[],title:{"zh-CN":""},width:0});Object.assign(u,s),i.push(u)}return t.widgets.splice(0,t.widgets.length),t.widgets.push(...i),t}getTitle(e){return v(this.title,e)}getDescription(e){return v(this.description,e)}getIndexUrl(e){return W.getWidgetPackageIndexUrl(this.url,this.entry,e??this.hash)}}const B="/hotspot/logo.png",O={class:"bubbly-button"},L=y({__name:"BubblyButton",props:{color:{type:String,default:"#4d89ea"},label:{type:String}},setup(l){return(e,t)=>(n(),o("button",O,[P(e.$slots,"icon",{},void 0,!0),U(" "+d(l.label),1)]))}});const b=k(L,[["__scopeId","data-v-608f4341"]]),p=l=>(N("data-v-c89764f7"),l=l(),S(),l),$={class:"widget-landing-page"},z={class:"widget-package-box"},T={class:"flex desc"},q=p(()=>a("img",{alt:"logo",class:"logo",src:B},null,-1)),A={class:"package-info flex-col"},R={class:"title"},V=p(()=>a("div",null,null,-1)),D={class:"widget-tag-group"},E={class:"marquee"},F={class:"marquee__group"},J=["src"],G={class:"marquee__group"},H=["src"],K={key:1,class:"error"},M=p(()=>a("p",null,"加载失败",-1)),Q=y({__name:"LandingPage",setup(l){const e=w(),t=w();x.get("/hotspot//widget.json").then(c=>{e.value=_.parseObject(c.data)}).catch(c=>{t.value=c});const i=j(()=>`widget://widgetjs.cn/package?url=${encodeURIComponent(e.value.remotePackage)}`),s=()=>{window.open("https://widgetjs.cn/")},u=()=>{window.location.href=i.value},m=c=>`/hotspot/${c}`.replaceAll("//","/");return(c,X)=>(n(),o("div",$,[a("div",z,[e.value?(n(),o(g,{key:0},[a("div",T,[q,a("div",A,[a("div",R,d(e.value.getTitle()),1),a("div",null,d(e.value.getDescription()),1),V,a("div",D,[(n(!0),o(g,null,h(e.value.widgets,r=>(n(),o("div",{class:"widget-tag",key:r.name},d(r.getTitle()),1))),128))])]),f(b,{style:{"margin-left":"auto"},label:"在客户端打开",onClick:u,class:"bubbly-button"}),f(b,{onClick:s,class:"bubbly-button",label:"下载客户端"})]),a("div",E,[a("div",F,[(n(!0),o(g,null,h(e.value.widgets,r=>(n(),o("img",{key:r.name,src:m(r.previewImage)},null,8,J))),128))]),a("div",G,[(n(!0),o(g,null,h(e.value.widgets,r=>(n(),o("img",{key:r.name,src:m(r.previewImage)},null,8,H))),128))])])],64)):t.value?(n(),o("div",K,[M,a("p",null,d(t.value.message),1),a("p",null,d(t.value.request.responseURL),1)])):C("",!0)])]))}});const ee=k(Q,[["__scopeId","data-v-c89764f7"]]);export{ee as default};
